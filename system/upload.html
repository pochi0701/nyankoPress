<DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title><?php echo $title; ?></title>
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Cache-Control" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="<?php global $bootstrap_css;echo $bootstrap_css;?>" rel="stylesheet">
    <style type="text/css">
        /* layout.css Style */
.upload-drop-zone {
  height: 200px;
  border-width: 2px;
  margin-bottom: 20px;
}

/* skin.css Style*/
.upload-drop-zone {
  color: #ccc;
  border-style: dashed;
  border-color: #ccc;
  line-height: 200px;
  text-align: center
}
.upload-drop-zone.drop {
  color: #222;
  border-color: #222;
}
    </style>
  <script src="<?php global $jquery_js;echo $jquery_js;?>"></script>
  <script src="<?php global $bootstrap_js;echo $bootstrap_js;?>"></script>
</head>
<body>
<div class="container">
    <div class="panel panel-default">
        <div class="panel-heading"><strong>メディアアップロード</strong> <small>Jpg,gif,png,pdf,mp4..</small></div>
        <div class="panel-body">
            <div id="result"><?php echo $errmsg; ?></div>
            <br />
            <form action="" method="post" enctype="multipart/form-data">
                <div class="form-inline">
                    <div class="form-group">
                        <input name="upfile[]" type="file" multiple="multiple" />
                    </div>
                    <button type="submit" class="btn btn-sm btn-primary" value="アップロードを実行する">Upload files</button>
                </div>
           </form>
           <div class="upload-drop-zone" id="drop-zone" ondragover="onUpload_DragOver(event)" ondrop="onUpload_Drop(event)">
            Just drag and drop files here
           </div>
        </div>
    </div>
</div>
<script type="text/javascript">
<!--
  // XMLHttpRequestオブジェクトの生成
  function createXmlHttpRequest(){
    if(window.XMLHttpRequest){
      return new XMLHttpRequest();
    }else if(window.ActiveXObject){
      try {
          return new ActiveXObject("MSXML2.XMLHTTP.6.0");
      } catch (e) {
        try {
           return new ActiveXObject("MSXML2.XMLHTTP.3.0");
        } catch (e2) {
          try {
              return new ActiveXObject("MSXML2.XMLHTTP");
          } catch (e3) {
             return null
          }
        }
      }
    }else {
        return null
    }
  }
  // サーバーへHttpリクエストの送信
  function sendHttpRequest(files){
      // XMLHttpRequestオブジェクトの生成
      var xmlhttp = createXmlHttpRequest();
      // イベントの設定
      xmlhttp.onreadystatechange = function() {
        // レスポンスの処理が完了後、コールバック関数へ渡す
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            // コールバック
            XmlHttpCallback(xmlhttp);
        }
      }
      // フォームデータの生成(HTML5)
      var fd = new FormData();
      for (var i=0; i< files.length; i++) {
          fd.append("upfile[]",files[i]);
      }
      xmlhttp.open('POST', 'index.php?mode=5&drop=1', true);
      // サーバにHTTPリクエストを送信
      xmlhttp.send(fd);
  }
  // コールバック関数(クライアント側への表示)
  function XmlHttpCallback(xmlhttp){
      var result = document.getElementById("result");
      result.innerHTML = xmlhttp.responseText;
  }
  // *** アップロード用ドラッグ&ドロップ
  function onUpload_DragOver(event){
      // イベントのキャンセル
      event.preventDefault();
  }
  function onUpload_Drop(event){
      if (event.dataTransfer.files.length !=0){
          // まとめて送信する
          sendHttpRequest(event.dataTransfer.files);
      }
      // イベントのキャンセル
      event.preventDefault();
  }
// -->
</script>
</body>
</html>
